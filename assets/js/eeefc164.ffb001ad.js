"use strict";(self.webpackChunksanchonet=self.webpackChunksanchonet||[]).push([[787],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),s=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),u=s(n),f=o,h=u["".concat(l,".").concat(f)]||u[f]||p[f]||r;return n?a.createElement(h,i(i({ref:t},d),{},{components:n})):a.createElement(h,i({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=f;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c[u]="string"==typeof e?e:o,i[1]=c;for(var s=2;s<r;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},5395:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>s});var a=n(7462),o=(n(7294),n(3905));const r={sidebar_label:"Voting on actions",title:"Voting on governance actions",sidebar_position:9,slug:"/tutorials/vote-action"},i=void 0,c={unversionedId:"tutorials/vote-actions",id:"tutorials/vote-actions",title:"Voting on governance actions",description:"Pre-requisites",source:"@site/docs/tutorials/vote-actions.mdx",sourceDirName:"tutorials",slug:"/tutorials/vote-action",permalink:"/tutorials/vote-action",draft:!1,editUrl:"https://github.com/input-output-hk/sanchonet/tree/master/docs/tutorials/vote-actions.mdx",tags:[],version:"current",sidebarPosition:9,frontMatter:{sidebar_label:"Voting on actions",title:"Voting on governance actions",sidebar_position:9,slug:"/tutorials/vote-action"},sidebar:"docsSidebar",previous:{title:"Create governance actions",permalink:"/tutorials/create-action"},next:{title:"Tools and resources",permalink:"/tools-resources/resources"}},l={},s=[{value:"Pre-requisites",id:"pre-requisites",level:3},{value:"Verify the content of the governance action",id:"verify-the-content-of-the-governance-action",level:3},{value:"Create the vote file",id:"create-the-vote-file",level:3},{value:"Include the vote in a transaction:",id:"include-the-vote-in-a-transaction",level:3}],d={toc:s},u="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h3",{id:"pre-requisites"},"Pre-requisites"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Payment key pair"),(0,o.kt)("li",{parentName:"ul"},"Address with funds"),(0,o.kt)("li",{parentName:"ul"},"DRep OR Stake pool keys"),(0,o.kt)("li",{parentName:"ul"},"A SanchoNet node")),(0,o.kt)("p",null,"To vote on governance actions, follow this process:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Obtain the action ID of an ongoing governance action from Discord or query the ledger"),(0,o.kt)("li",{parentName:"ol"},"Determine your voting stance; engage in discussion if required"),(0,o.kt)("li",{parentName:"ol"},"Construct your vote file through the Cardano CLI. The example below demonstrates voting ",(0,o.kt)("inlineCode",{parentName:"li"},"--yes"),", although options for ",(0,o.kt)("inlineCode",{parentName:"li"},"--no")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"--abstain")," are also available.")),(0,o.kt)("h3",{id:"verify-the-content-of-the-governance-action"},"Verify the content of the governance action"),(0,o.kt)("p",null,"Assume that we have been given the action ID ",(0,o.kt)("inlineCode",{parentName:"p"},"8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da#0")," for a new constitution proposal."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Obtain the URL and hash of the new constitution proposal from the ledger state:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cardano-cli query ledger-state --testnet-magic 4 | \\\njq -r --arg key_to_match \"8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da#0\" \\\n'.stateBefore.esLState.utxoState.ppups.gov | select(.[$key_to_match] != null) | {($key_to_match): .[$key_to_match]}'\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{\n  "8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da#0": {\n    "committeeVotes": [],\n    "dRepVotes": [],\n    "stakePoolVotes": {},\n    "deposit": 1000000,\n    "returnAddr": {\n      "credential": {\n        "key hash": "51330288da94527431d242993fa1f73ec4043549a073e1cfba9db3bf"\n      },\n      "network": "Testnet"\n    },\n    "action": {\n      "contents": [\n        null,\n        {\n          "constitutionAnchor": {\n            "dataHash": "3d2a9d15382c14f5ca260a2f5bfb645fe148bfe10c1d0e1d305b7b1393e2bd97",\n            "url": "https://shorturl.at/asIJ6"\n          }\n        }\n      ],\n      "tag": "NewConstitution"\n    },\n    "proposedIn": 1\n  }\n}\n')),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Download the file from the URL registered on the ledger state:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"wget https://shorturl.at/asIJ6 -O constitution.txt\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Verify that the hash of the file matches the ",(0,o.kt)("inlineCode",{parentName:"li"},"dataHash"),"from the ledger state:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"b2sum -l 256 constitution.txt\n3d2a9d15382c14f5ca260a2f5bfb645fe148bfe10c1d0e1d305b7b1393e2bd97  constitution.txt\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Everything is in order; the text at the URL matches the dataHash, confirming that the text at the URL is precisely what we are voting for.")),(0,o.kt)("p",null,"In the future, voting apps, explorers, wallets, and other tools could perform the filtering, ensuring that they only display actions whose URL content has been verified against the hash on the ledger state."),(0,o.kt)("h3",{id:"create-the-vote-file"},"Create the vote file"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Vote with DRep keys")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'cardano-cli conway governance vote create \\\n    --yes \\\n    --governance-action-tx-id "8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da" \\\n    --governance-action-index "0" \\\n    --drep-verification-key-file drep.vkey \\\n    --out-file 8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da-constitution.vote\n')),(0,o.kt)("p",null,"OR"),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Vote with SPO keys")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'cardano-cli conway governance vote create \\\n    --yes \\\n    --governance-action-tx-id "8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da" \\\n    --governance-action-index "0" \\\n    --cold-verification-key-file cold.vkey \\\n    --out-file 8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da-constitution.vote\n')),(0,o.kt)("h3",{id:"include-the-vote-in-a-transaction"},"Include the vote in a transaction:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Build, sign, and submit the transaction:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cardano-cli transaction build --testnet-magic 4 --conway-era \\\n    --tx-in \"$(cardano-cli query utxo --address $(cat payment.addr) --testnet-magic 4 --out-file /dev/stdout | jq -r 'keys[0]')\" \\\n    --change-address $(cat payment.addr) \\\n    --vote-file 8a02dfbd297afbcb32e72fa94117f3e255100c1cb5c083e84e1c977ed5aca0da-constitution.vote \\\n    --witness-override 2 \\\n    --out-file vote-tx.raw\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cardano-cli transaction sign --tx-body-file vote-tx.raw \\\n    --signing-key-file drep.skey \\\n    --signing-key-file payment.skey \\\n    --testnet-magic 4 \\\n    --out-file vote-tx.signed\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cardano-cli transaction submit --testnet-magic 4 --tx-file vote-tx.signed\n")))}p.isMDXComponent=!0}}]);